pkgname=sddm-qt5-git
pkgver=0.0.0
pkgrel=1
pkgdesc="QML based X11 display manager"
arch=('i686' 'x86_64')
url="http://github.com/sddm/sddm"
license=('GPL')
depends=('pam' 'qt5-base-git' 'qt5-declarative-git' 'libx11')
makedepends=('cmake' 'git')
provides=('sddm')
replaces=('sddm')

_gitroot="git://github.com/sddm/sddm.git"
_gitbranch=master
_gitname=sddm
source=(${_gitname}::${_gitroot}#branch=${_gitbranch})
md5sums=('SKIP')

pkgver() {
  cd ${srcdir}/${_gitname}
  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

build() {
  cd ${srcdir}/${_gitname}

  mkdir -p build
  cd build

  cmake ../${_gitname} -DCMAKE_INSTALL_PREFIX=/usr -DUSE_QT5=true
  make
}

package() {
  cd ${srcdir}/${_gitname}/build
  make DESTDIR="${pkgdir}" install
}
